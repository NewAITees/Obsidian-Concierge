# Python用 AI支援コーディングのCursorルールセット - 核心原則

## I. Webアプリケーション向け核心原則

### 1. プロジェクト構造とコード編成
- **明確な責任分離**：機能ごとにモジュールを分割し、単一責任の原則に従う
- **小さなファイルサイズ維持**：50-100KB以下、500-1000行以下を目標とする
- **「歩くスケルトン」アプローチ**：エンドツーエンドで動作する最小限の実装を早期に作成
- **状態管理の明確化**：状態を持つコンポーネントと持たないコンポーネントを意識的に設計

### 2. 型システムの活用
- **静的型付けの徹底**：すべての関数とクラスに型ヒントを付与
- **型エイリアスとカスタム型**：複雑な型は明示的に定義
- **Pydanticとの統合**：APIインターフェイスの検証とドキュメント化
- **mypyによる継続的な型チェック**：CIパイプラインに組み込む

### 3. AI支援に最適化された開発フロー
- **「掘り続ける」問題への対応**：実装前に計画を立て、途中で方針転換できるようにする
- **リファクタリングの先行**：変更を加える前にコードを整理して変更を容易にする
- **「三回の法則」の適用**：コードが3回出現したらリファクタリングする
- **自動フォーマットの活用**：`black`や`isort`などのツールでスタイル調整を自動化

### 4. ドキュメンテーションと可読性
- **明確なdocstrings**：すべての公開API要素に詳細な説明を付与
- **コメントの質**：「何を」ではなく「なぜ」を説明
- **セルフドキュメンティングコード**：説明的な変数名と関数名
- **例示の提供**：複雑な機能には使用例を含める

### 5. テスト戦略
- **ブラックボックステスト**：実装とテストを明確に分離
- **パラメータ化テスト**：同様のロジックを複数のケースでテスト
- **科学的デバッグ**：観察、仮説、実験の流れを明示的に行う
- **テストの独立性**：各テストは他のテストに依存せず実行可能

## II. LLMアプリケーション向け核心原則

### 1. LLM統合アーキテクチャ
- **責任の分離**：プロンプト管理、LLM呼び出し、レスポンス処理を分離
- **モデル抽象化**：具体的なLLMの実装詳細から独立したインターフェース
- **メモリと文脈管理**：会話履歴と長期記憶の明示的な設計
- **MCPサーバー活用**：エージェント機能のためのModel Context Protocolの標準化

### 2. プロンプトエンジニアリング
- **バージョン管理されたテンプレート**：プロンプトの変更履歴を追跡
- **コンテキスト最適化**：LLMに必要な情報を効率的に提供
- **テスト可能なプロンプト**：プロンプトの有効性を客観的に評価
- **再利用可能なコンポーネント**：共通パターンのテンプレート化

### 3. ミザンプラス（準備と環境設定）
- **環境の事前設定**：LLM作業を始める前に必要なすべてを準備
- **リソースへのアクセス確保**：必要なファイル、API、ツールを事前に用意
- **開発環境の標準化**：一貫した結果のための再現可能な環境
- **エラーハンドリング戦略**：LLM関連の失敗に対する堅牢な対応

### 4. 静的型付けと安全性
- **LLMインターフェースの型定義**：入出力の明確な構造化
- **スキーマ検証**：LLMレスポンスの体系的な検証
- **型安全なツール呼び出し**：MCPツールのインターフェース定義
- **エラー状態の明示的な型付け**：失敗ケースの体系的な処理

### 5. メモリと状態管理
- **メメント問題への対応**：LLMの記憶限界を補う明示的な状態管理
- **長期・短期記憶の区別**：異なる寿命を持つデータの適切な保存
- **会話コンテキストの最適化**：トークン制限内で最大の文脈を提供
- **状態の永続化**：セッション間でのコンテキスト維持

## III. 共通する基本原則

### 1. コード品質
- **一貫したスタイル**：PEP 8準拠と自動フォーマット
- **明確な命名規則**：意図を反映した変数・関数・クラス名
- **DRY原則**：コードの重複を避ける
- **SOLID原則**：特にSingle Responsibility Principleを重視

### 2. エラー処理
- **具体的な例外型**：汎用例外ではなく明確に型付けされた例外
- **エラーの文脈提供**：デバッグに役立つ情報を含める
- **回復可能性の考慮**：エラーからの適切な回復戦略
- **ログ記録**：エラーの詳細な記録とモニタリング

### 3. ロギング
- **構造化ログ**：機械処理可能な形式
- **適切なログレベル**：情報の重要性に応じた区分
- **コンテキスト情報**：関連するメタデータの記録
- **プライバシー考慮**：センシティブ情報の適切な処理

### 4. 仕様の尊重
- **APIの安定性**：下位互換性の維持
- **ドキュメント主導開発**：仕様から実装へのワークフロー
- **契約プログラミング**：事前条件と事後条件の明示
- **テストによる仕様検証**：自動テストによる仕様準拠の確認

### 5. 科学的アプローチ
- **観察と仮説**：問題に対する体系的アプローチ
- **実験的実装**：小規模な変更で検証
- **データに基づく決定**：主観ではなく測定可能な改善
- **反復的改善**：継続的なフィードバックサイクル